/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function _toPrimitive(t,e){if("object"!==_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===_typeof(i)?i:String(i)),n)}var o,i}var t=function(){function Api(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Api),this.baseUrl=t,this.options={headers:Object.assign({"Content-Type":"application/json"},null!==(e=r.headers)&&void 0!==e?e:{})}}return function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(Api,[{key:"handleResponse",value:function handleResponse(t){return t.ok?t.json():t.json().then((function(e){var r;return Promise.reject(null!==(r=e.error)&&void 0!==r?r:t.statusText)}))}},{key:"get",value:function get(t){return fetch(this.baseUrl+t,Object.assign(Object.assign({},this.options),{method:"GET"})).then(this.handleResponse)}},{key:"post",value:function post(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST";return fetch(this.baseUrl+t,Object.assign(Object.assign({},this.options),{method:r,body:JSON.stringify(e)})).then(this.handleResponse)}}]),Api}(),e="https://larek-api.nomoreparties.co",r=("".concat(e,"/api/weblarek"),"".concat(e,"/content/weblarek"));function AppState_typeof(t){return AppState_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},AppState_typeof(t)}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,o){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),s=new Context(o||[]);return n(a,"_invoke",{value:makeInvokeMethod(t,r,s)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var c={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var u={};define(u,i,(function(){return this}));var l=Object.getPrototypeOf,f=l&&l(l(values([])));f&&f!==e&&r.call(f,i)&&(u=f);var p=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(u);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(n,o,i,a){var s=tryCatch(t[n],t,o);if("throw"!==s.type){var c=s.arg,u=c.value;return u&&"object"==AppState_typeof(u)&&r.call(u,"__await")?e.resolve(u.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(u).then((function(t){c.value=t,i(c)}),(function(t){return invoke("throw",t,i,a)}))}a(s.arg)}var o;n(this,"_invoke",{value:function value(t,r){function callInvokeWithMethodAndArg(){return new e((function(e,n){invoke(t,r,e,n)}))}return o=o?o.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return doneResult()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=maybeInvokeDelegate(a,r);if(s){if(s===c)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=tryCatch(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===c)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function maybeInvokeDelegate(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,maybeInvokeDelegate(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),c;var o=tryCatch(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,c;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,c):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,c)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function next(){for(;++n<t.length;)if(r.call(t,n))return next.value=t[n],next.done=!1,next;return next.value=void 0,next.done=!0,next};return o.next=o}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,n(p,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),n(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,s,"GeneratorFunction")),t.prototype=Object.create(p),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,a,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(p),define(p,s,"Generator"),define(p,i,(function(){return this})),define(p,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var e=this;function handle(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],i=o.completion;if("root"===o.tryLoc)return handle("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),s=r.call(o,"finallyLoc");if(a&&s){if(this.prev<o.catchLoc)return handle(o.catchLoc,!0);if(this.prev<o.finallyLoc)return handle(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return handle(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return handle(o.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,c):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),c}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,e,r){return this.delegate={iterator:values(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),c}},t}function asyncGeneratorStep(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function _next(t){asyncGeneratorStep(i,n,o,_next,_throw,"next",t)}function _throw(t){asyncGeneratorStep(i,n,o,_next,_throw,"throw",t)}_next(void 0)}))}}function AppState_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function AppState_toPrimitive(t,e){if("object"!==AppState_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==AppState_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===AppState_typeof(i)?i:String(i)),n)}var o,i}var n=function(){function AppState(t){!function AppState_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,AppState),this.api=t,this._products=[],this._basket=[],this._order={payment:"online",address:"",email:"",phone:"",items:[],total:0}}var t,e;return function AppState_createClass(t,e,r){return e&&AppState_defineProperties(t.prototype,e),r&&AppState_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(AppState,[{key:"loadProducts",value:(e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(){var t;return _regeneratorRuntime().wrap((function _callee$(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.api.get("/product");case 3:return t=e.sent,this._products=t.items.map((function(t){return Object.assign(Object.assign({},t),{image:t.image?"".concat(r,"/").concat(t.image):t.image})})),e.abrupt("return",this._products);case 8:throw e.prev=8,e.t0=e.catch(0),console.error("Ошибка загрузки продуктов:",e.t0),e.t0;case 12:case"end":return e.stop()}}),_callee,this,[[0,8]])}))),function loadProducts(){return e.apply(this,arguments)})},{key:"getBasketItems",value:function getBasketItems(){return this._basket.map((function(t,e){return{product:t,index:e+1}}))}},{key:"addToBasket",value:function addToBasket(t){this._basket.push(t)}},{key:"removeFromBasket",value:function removeFromBasket(t){this._basket=this._basket.filter((function(e){return e.id!==t}))}},{key:"clearBasket",value:function clearBasket(){this._basket=[]}},{key:"getBasketTotal",value:function getBasketTotal(){return this._basket.reduce((function(t,e){return t+(e.price||0)}),0)}},{key:"isInBasket",value:function isInBasket(t){return this._basket.some((function(e){return e.id===t}))}},{key:"updateOrder",value:function updateOrder(t){this._order=Object.assign(Object.assign({},this._order),t)}},{key:"submitOrder",value:(t=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(){var t,e;return _regeneratorRuntime().wrap((function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:return t=Object.assign(Object.assign({},this._order),{items:this._basket.map((function(t){return t.id})),total:this.getBasketTotal()}),r.prev=1,r.next=4,this.api.post("/order",t);case 4:return e=r.sent,this.clearBasket(),r.abrupt("return",e);case 9:throw r.prev=9,r.t0=r.catch(1),console.error("Ошибка оформления заказа:",r.t0),r.t0;case 13:case"end":return r.stop()}}),_callee2,this,[[1,9]])}))),function submitOrder(){return t.apply(this,arguments)})},{key:"products",get:function get(){return this._products}},{key:"basket",get:function get(){return this._basket}},{key:"order",get:function get(){return this._order}}]),AppState}();function View_typeof(t){return View_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},View_typeof(t)}function View_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function View_toPrimitive(t,e){if("object"!==View_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==View_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===View_typeof(i)?i:String(i)),n)}var o,i}var o=function(){function View(t){!function View_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,View),this.container="string"==typeof t?document.querySelector(t):t}return function View_createClass(t,e,r){return e&&View_defineProperties(t.prototype,e),r&&View_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(View,[{key:"element",get:function get(){return this.container}},{key:"setText",value:function setText(t,e){t.textContent=e}},{key:"setImage",value:function setImage(t,e,r){t.src=e,t.alt=r}},{key:"setDisabled",value:function setDisabled(t,e){e?t.setAttribute("disabled","true"):t.removeAttribute("disabled")}},{key:"toggleClass",value:function toggleClass(t,e,r){t.classList.toggle(e,r)}},{key:"hide",value:function hide(t){t.style.display="none"}},{key:"show",value:function show(t){t.style.display=""}}]),View}();function Modal_typeof(t){return Modal_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Modal_typeof(t)}function Modal_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function Modal_toPrimitive(t,e){if("object"!==Modal_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Modal_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===Modal_typeof(i)?i:String(i)),n)}var o,i}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _createSuper(t){var e=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function _possibleConstructorReturn(t,e){if(e&&("object"===Modal_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}var i=function(t){!function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}(Modal,t);var e=_createSuper(Modal);function Modal(t){var r;return function Modal_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Modal),(r=e.call(this,t)).closeButton=r.container.querySelector(".modal__close"),r.closeButton.addEventListener("click",(function(){return r.close()})),r.container.addEventListener("click",(function(t){t.target===r.container&&r.close()})),r}return function Modal_createClass(t,e,r){return e&&Modal_defineProperties(t.prototype,e),r&&Modal_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(Modal,[{key:"open",value:function open(){this.container.classList.add("modal_active")}},{key:"close",value:function close(){this.container.classList.remove("modal_active")}},{key:"setContent",value:function setContent(t){var e=this.container.querySelector(".modal__content");e.innerHTML="",e.appendChild(t)}}]),Modal}(o),a={"софт-скил":"soft",другое:"other",дополнительное:"additional",кнопка:"button","хард-скил":"hard"};function Card_typeof(t){return Card_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Card_typeof(t)}function Card_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function Card_toPrimitive(t,e){if("object"!==Card_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Card_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===Card_typeof(i)?i:String(i)),n)}var o,i}function Card_setPrototypeOf(t,e){return Card_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,e){return t.__proto__=e,t},Card_setPrototypeOf(t,e)}function Card_createSuper(t){var e=function Card_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var r,n=Card_getPrototypeOf(t);if(e){var o=Card_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function Card_possibleConstructorReturn(t,e){if(e&&("object"===Card_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function Card_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function Card_getPrototypeOf(t){return Card_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},Card_getPrototypeOf(t)}var s=function(t){!function Card_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Card_setPrototypeOf(t,e)}(Card,t);var e=Card_createSuper(Card);function Card(t){var r;return function Card_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Card),(r=e.call(this,t)).title=r.container.querySelector(".card__title"),r.price=r.container.querySelector(".card__price"),r.image=r.container.querySelector(".card__image"),r.category=r.container.querySelector(".card__category"),r.button=r.container.querySelector(".card__button"),r}return function Card_createClass(t,e,r){return e&&Card_defineProperties(t.prototype,e),r&&Card_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(Card,[{key:"render",value:function render(t,e){this.setText(this.title,t.title),null===t.price?(this.setText(this.price,"Бесценно"),this.button&&(this.setText(this.button,"Недоступно"),this.setDisabled(this.button,!0))):(this.setText(this.price,"".concat(t.price," синапсов")),this.button&&(this.setText(this.button,e?"Удалить из корзины":"В корзину"),this.setDisabled(this.button,!1))),this.setImage(this.image,t.image,t.title),this.setText(this.category,t.category);var r=a[t.category]||"other";this.category.className="card__category card__category_".concat(r)}},{key:"setButtonHandler",value:function setButtonHandler(t){var e=this;this.button&&this.button.addEventListener("click",(function(){var r="В корзину"===e.button.textContent;t(r)}))}},{key:"setClickHandler",value:function setClickHandler(t){this.container.addEventListener("click",t)}}]),Card}(o);function Basket_typeof(t){return Basket_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Basket_typeof(t)}function Basket_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function Basket_toPrimitive(t,e){if("object"!==Basket_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Basket_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===Basket_typeof(i)?i:String(i)),n)}var o,i}function Basket_setPrototypeOf(t,e){return Basket_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,e){return t.__proto__=e,t},Basket_setPrototypeOf(t,e)}function Basket_createSuper(t){var e=function Basket_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var r,n=Basket_getPrototypeOf(t);if(e){var o=Basket_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function Basket_possibleConstructorReturn(t,e){if(e&&("object"===Basket_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function Basket_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function Basket_getPrototypeOf(t){return Basket_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},Basket_getPrototypeOf(t)}var c=function(t){!function Basket_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Basket_setPrototypeOf(t,e)}(Basket,t);var e=Basket_createSuper(Basket);function Basket(t){var r;return function Basket_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Basket),(r=e.call(this,t)).list=r.container.querySelector(".basket__list"),r.total=r.container.querySelector(".basket__price"),r.button=r.container.querySelector(".basket__button"),r}return function Basket_createClass(t,e,r){return e&&Basket_defineProperties(t.prototype,e),r&&Basket_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(Basket,[{key:"render",value:function render(t,e){var r=this;this.list.innerHTML="",t.forEach((function(t){var e=r.createBasketItem(t);r.list.appendChild(e)})),this.setText(this.total,"".concat(e," синапсов")),this.setDisabled(this.button,0===t.length)}},{key:"createBasketItem",value:function createBasketItem(t){var e=document.querySelector("#card-basket").content.cloneNode(!0),r=e.querySelector(".basket__item"),n=e.querySelector(".basket__item-index"),o=e.querySelector(".card__title"),i=e.querySelector(".card__price");e.querySelector(".basket__item-delete");return this.setText(n,t.index.toString()),this.setText(o,t.product.title),this.setText(i,"".concat(t.product.price," синапсов")),r.dataset.id=t.product.id,r}},{key:"setOrderHandler",value:function setOrderHandler(t){this.button.addEventListener("click",t)}},{key:"setDeleteHandler",value:function setDeleteHandler(t){this.list.addEventListener("click",(function(e){var r=e.target;if(r.classList.contains("basket__item-delete")){var n=r.closest(".basket__item").dataset.id;t(n)}}))}}]),Basket}(o);function OrderForm_typeof(t){return OrderForm_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},OrderForm_typeof(t)}function OrderForm_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function OrderForm_toPrimitive(t,e){if("object"!==OrderForm_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==OrderForm_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===OrderForm_typeof(i)?i:String(i)),n)}var o,i}function OrderForm_setPrototypeOf(t,e){return OrderForm_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,e){return t.__proto__=e,t},OrderForm_setPrototypeOf(t,e)}function OrderForm_createSuper(t){var e=function OrderForm_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var r,n=OrderForm_getPrototypeOf(t);if(e){var o=OrderForm_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function OrderForm_possibleConstructorReturn(t,e){if(e&&("object"===OrderForm_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function OrderForm_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function OrderForm_getPrototypeOf(t){return OrderForm_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},OrderForm_getPrototypeOf(t)}var u=function(t){!function OrderForm_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&OrderForm_setPrototypeOf(t,e)}(OrderForm,t);var e=OrderForm_createSuper(OrderForm);function OrderForm(t){var r;return function OrderForm_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,OrderForm),(r=e.call(this,t)).paymentButtons=r.container.querySelectorAll(".button_alt"),r.addressInput=r.container.querySelector('input[name="address"]'),r.submitButton=r.container.querySelector('button[type="submit"]'),r.errorsContainer=r.container.querySelector(".form__errors"),r}return function OrderForm_createClass(t,e,r){return e&&OrderForm_defineProperties(t.prototype,e),r&&OrderForm_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(OrderForm,[{key:"render",value:function render(t){var e=this;this.paymentButtons.forEach((function(r){e.toggleClass(r,"button_active",r.name===t.payment),e.toggleClass(r,"button_alt-active",r.name===t.payment)})),t.address&&(this.addressInput.value=t.address),this.validateForm(),this.hideErrors()}},{key:"validateForm",value:function validateForm(){var t=[];return this.addressInput.value.trim().length<5&&t.push("Необходимо указать адрес"),Array.from(this.paymentButtons).some((function(t){return t.classList.contains("button_active")}))||t.push("Выберите способ оплаты"),t.length>0?(this.showErrors(t),this.setDisabled(this.submitButton,!0),!1):(this.hideErrors(),this.setDisabled(this.submitButton,!1),!0)}},{key:"setHandlers",value:function setHandlers(){var t=this;this.paymentButtons.forEach((function(e){e.addEventListener("click",(function(){t.paymentButtons.forEach((function(e){t.toggleClass(e,"button_active",!1),t.toggleClass(e,"button_alt-active",!1)})),t.toggleClass(e,"button_active",!0),t.toggleClass(e,"button_alt-active",!0),t.validateForm()}))})),this.addressInput.addEventListener("input",(function(){t.validateForm()}))}},{key:"getFormData",value:function getFormData(){var t;return{payment:null===(t=Array.from(this.paymentButtons).find((function(t){return t.classList.contains("button_active")})))||void 0===t?void 0:t.name,address:this.addressInput.value.trim()}}},{key:"setSubmitHandler",value:function setSubmitHandler(t){var e=this;this.container.addEventListener("submit",(function(r){r.preventDefault(),e.validateForm()&&t(r)}))}},{key:"showErrors",value:function showErrors(t){this.errorsContainer.textContent=t.join(". "),this.show(this.errorsContainer)}},{key:"hideErrors",value:function hideErrors(){this.errorsContainer.textContent="",this.hide(this.errorsContainer)}}]),OrderForm}(o);function ContactsForm_typeof(t){return ContactsForm_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ContactsForm_typeof(t)}function ContactsForm_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function ContactsForm_toPrimitive(t,e){if("object"!==ContactsForm_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==ContactsForm_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===ContactsForm_typeof(i)?i:String(i)),n)}var o,i}function ContactsForm_setPrototypeOf(t,e){return ContactsForm_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,e){return t.__proto__=e,t},ContactsForm_setPrototypeOf(t,e)}function ContactsForm_createSuper(t){var e=function ContactsForm_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var r,n=ContactsForm_getPrototypeOf(t);if(e){var o=ContactsForm_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function ContactsForm_possibleConstructorReturn(t,e){if(e&&("object"===ContactsForm_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function ContactsForm_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function ContactsForm_getPrototypeOf(t){return ContactsForm_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},ContactsForm_getPrototypeOf(t)}var l=function(t){!function ContactsForm_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ContactsForm_setPrototypeOf(t,e)}(ContactsForm,t);var e=ContactsForm_createSuper(ContactsForm);function ContactsForm(t){var r;return function ContactsForm_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,ContactsForm),(r=e.call(this,t)).emailInput=r.container.querySelector('input[name="email"]'),r.phoneInput=r.container.querySelector('input[name="phone"]'),r.submitButton=r.container.querySelector('button[type="submit"]'),r.errorsContainer=r.container.querySelector(".form__errors"),r}return function ContactsForm_createClass(t,e,r){return e&&ContactsForm_defineProperties(t.prototype,e),r&&ContactsForm_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(ContactsForm,[{key:"render",value:function render(t){t.email&&(this.emailInput.value=t.email),t.phone&&(this.phoneInput.value=t.phone),this.validateForm(),this.hideErrors()}},{key:"validateForm",value:function validateForm(){var t=[],e=this.emailInput.value.trim(),r=this.phoneInput.value.trim();/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)||t.push("Введите корректный email");var n=r.replace(/\D/g,"");return 11===n.length&&n.startsWith("7")||t.push("Введите телефон в формате +7 (XXX) XXX-XX-XX"),t.length>0?(this.showErrors(t),this.setDisabled(this.submitButton,!0),!1):(this.hideErrors(),this.setDisabled(this.submitButton,!1),!0)}},{key:"setHandlers",value:function setHandlers(){var t=this;this.phoneInput.addEventListener("input",(function(e){var r=e.target,n=r.value.replace(/\D/g,"");if(n.length>11&&(n=n.substring(0,11)),n.length>0){n.startsWith("7")||(n="7"+n).length>11&&(n=n.substring(0,11));var o="+7";n.length>1&&(o+=" (".concat(n.substring(1,4))),n.length>4&&(o+=") ".concat(n.substring(4,7))),n.length>7&&(o+="-".concat(n.substring(7,9))),n.length>9&&(o+="-".concat(n.substring(9,11))),r.value=o}t.validateForm()})),this.emailInput.addEventListener("input",(function(){return t.validateForm()})),this.phoneInput.addEventListener("input",(function(){return t.validateForm()}))}},{key:"getFormData",value:function getFormData(){return{email:this.emailInput.value.trim(),phone:this.phoneInput.value.replace(/\D/g,"")}}},{key:"setSubmitHandler",value:function setSubmitHandler(t){var e=this;this.container.addEventListener("submit",(function(r){r.preventDefault(),e.validateForm()&&t(r)}))}},{key:"showErrors",value:function showErrors(t){this.errorsContainer.textContent=t.join(". "),this.show(this.errorsContainer)}},{key:"hideErrors",value:function hideErrors(){this.errorsContainer.textContent="",this.hide(this.errorsContainer)}}]),ContactsForm}(o);function SuccessMessage_typeof(t){return SuccessMessage_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},SuccessMessage_typeof(t)}function SuccessMessage_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function SuccessMessage_toPrimitive(t,e){if("object"!==SuccessMessage_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==SuccessMessage_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===SuccessMessage_typeof(i)?i:String(i)),n)}var o,i}function SuccessMessage_setPrototypeOf(t,e){return SuccessMessage_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,e){return t.__proto__=e,t},SuccessMessage_setPrototypeOf(t,e)}function SuccessMessage_createSuper(t){var e=function SuccessMessage_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var r,n=SuccessMessage_getPrototypeOf(t);if(e){var o=SuccessMessage_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function SuccessMessage_possibleConstructorReturn(t,e){if(e&&("object"===SuccessMessage_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function SuccessMessage_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function SuccessMessage_getPrototypeOf(t){return SuccessMessage_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},SuccessMessage_getPrototypeOf(t)}var f=function(t){!function SuccessMessage_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&SuccessMessage_setPrototypeOf(t,e)}(SuccessMessage,t);var e=SuccessMessage_createSuper(SuccessMessage);function SuccessMessage(t){var r;return function SuccessMessage_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,SuccessMessage),(r=e.call(this,t)).title=r.container.querySelector(".order-success__title"),r.description=r.container.querySelector(".order-success__description"),r.closeButton=r.container.querySelector(".order-success__close"),r}return function SuccessMessage_createClass(t,e,r){return e&&SuccessMessage_defineProperties(t.prototype,e),r&&SuccessMessage_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(SuccessMessage,[{key:"render",value:function render(t){this.setText(this.description,"Списано ".concat(t.total," синапсов"))}},{key:"setCloseHandler",value:function setCloseHandler(t){this.closeButton.addEventListener("click",t)}}]),SuccessMessage}(o);function App_typeof(t){return App_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},App_typeof(t)}function App_regeneratorRuntime(){App_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,o){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),s=new Context(o||[]);return n(a,"_invoke",{value:makeInvokeMethod(t,r,s)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var c={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var u={};define(u,i,(function(){return this}));var l=Object.getPrototypeOf,f=l&&l(l(values([])));f&&f!==e&&r.call(f,i)&&(u=f);var p=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(u);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(n,o,i,a){var s=tryCatch(t[n],t,o);if("throw"!==s.type){var c=s.arg,u=c.value;return u&&"object"==App_typeof(u)&&r.call(u,"__await")?e.resolve(u.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(u).then((function(t){c.value=t,i(c)}),(function(t){return invoke("throw",t,i,a)}))}a(s.arg)}var o;n(this,"_invoke",{value:function value(t,r){function callInvokeWithMethodAndArg(){return new e((function(e,n){invoke(t,r,e,n)}))}return o=o?o.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return doneResult()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=maybeInvokeDelegate(a,r);if(s){if(s===c)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=tryCatch(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===c)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function maybeInvokeDelegate(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,maybeInvokeDelegate(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),c;var o=tryCatch(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,c;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,c):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,c)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function next(){for(;++n<t.length;)if(r.call(t,n))return next.value=t[n],next.done=!1,next;return next.value=void 0,next.done=!0,next};return o.next=o}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,n(p,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),n(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,s,"GeneratorFunction")),t.prototype=Object.create(p),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,a,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(p),define(p,s,"Generator"),define(p,i,(function(){return this})),define(p,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var e=this;function handle(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],i=o.completion;if("root"===o.tryLoc)return handle("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),s=r.call(o,"finallyLoc");if(a&&s){if(this.prev<o.catchLoc)return handle(o.catchLoc,!0);if(this.prev<o.finallyLoc)return handle(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return handle(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return handle(o.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,c):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),c}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,e,r){return this.delegate={iterator:values(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),c}},t}function App_asyncGeneratorStep(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function App_asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function _next(t){App_asyncGeneratorStep(i,n,o,_next,_throw,"next",t)}function _throw(t){App_asyncGeneratorStep(i,n,o,_next,_throw,"throw",t)}_next(void 0)}))}}function App_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function App_toPrimitive(t,e){if("object"!==App_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==App_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===App_typeof(i)?i:String(i)),n)}var o,i}var p=function(){function App(t){!function App_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,App),this.model=t,this.currentPreviewProduct=null,this.initViews(),this.initEventHandlers(),this.loadProducts()}var t,e;return function App_createClass(t,e,r){return e&&App_defineProperties(t.prototype,e),r&&App_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(App,[{key:"initViews",value:function initViews(){this.modal=new i(document.querySelector("#modal-container"));var t=document.querySelector("#card-preview");this.productCard=new s(t.content.querySelector(".card"));var e=document.querySelector("#basket");this.basket=new c(e.content.querySelector(".basket"));var r=document.querySelector("#order");this.orderForm=new u(r.content.querySelector(".form"));var n=document.querySelector("#contacts");this.contactsForm=new l(n.content.querySelector(".form"));var o=document.querySelector("#success");this.successMessage=new f(o.content.querySelector(".order-success"))}},{key:"initEventHandlers",value:function initEventHandlers(){var t=this;document.querySelector(".header__basket").addEventListener("click",(function(){t.openBasket()})),this.orderForm.setHandlers(),this.orderForm.setSubmitHandler((function(e){e.preventDefault(),t.processOrderStep1()})),this.contactsForm.setHandlers(),this.contactsForm.setSubmitHandler((function(e){e.preventDefault(),t.processOrderStep2()})),this.successMessage.setCloseHandler((function(){t.modal.close()})),this.productCard.setButtonHandler((function(e){t.currentPreviewProduct&&(e?t.model.addToBasket(t.currentPreviewProduct):t.model.removeFromBasket(t.currentPreviewProduct.id),t.updateBasketCounter(),t.renderProducts(),t.modal.close())}))}},{key:"loadProducts",value:(e=App_asyncToGenerator(App_regeneratorRuntime().mark((function _callee(){return App_regeneratorRuntime().wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.model.loadProducts();case 3:this.renderProducts(),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error("Ошибка загрузки продуктов:",t.t0);case 9:case"end":return t.stop()}}),_callee,this,[[0,6]])}))),function loadProducts(){return e.apply(this,arguments)})},{key:"renderProducts",value:function renderProducts(){var t=this,e=document.querySelector(".gallery");e.innerHTML="";var r=document.querySelector("#card-catalog");this.model.products.forEach((function(n){var o=r.content.cloneNode(!0),i=o.querySelector(".card"),a=new s(i);a.render(n,t.model.isInBasket(n.id)),a.setClickHandler((function(){t.openProductPreview(n)})),a.setButtonHandler((function(e){e?t.model.addToBasket(n):t.model.removeFromBasket(n.id),t.updateBasketCounter(),t.renderProducts()})),e.appendChild(o)})),this.updateBasketCounter()}},{key:"openProductPreview",value:function openProductPreview(t){this.currentPreviewProduct=t,this.productCard.render(t,this.model.isInBasket(t.id)),this.modal.setContent(this.productCard.element),this.modal.open()}},{key:"updateBasketCounter",value:function updateBasketCounter(){document.querySelector(".header__basket-counter").textContent=this.model.basket.length.toString()}},{key:"openBasket",value:function openBasket(){var t=this,e=this.model.getBasketItems(),r=this.model.getBasketTotal();this.basket.render(e,r),this.basket.setOrderHandler((function(){t.openOrderForm()})),this.basket.setDeleteHandler((function(e){t.model.removeFromBasket(e),t.openBasket(),t.updateBasketCounter(),t.renderProducts()})),this.modal.setContent(this.basket.element),this.modal.open()}},{key:"openOrderForm",value:function openOrderForm(){this.orderForm.render(this.model.order),this.modal.setContent(this.orderForm.element)}},{key:"processOrderStep1",value:function processOrderStep1(){var t=this.orderForm.getFormData();this.model.updateOrder(t),this.openContactsForm()}},{key:"openContactsForm",value:function openContactsForm(){this.contactsForm.render(this.model.order),this.modal.setContent(this.contactsForm.element)}},{key:"processOrderStep2",value:(t=App_asyncToGenerator(App_regeneratorRuntime().mark((function _callee2(){var t,e;return App_regeneratorRuntime().wrap((function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:return t=this.contactsForm.getFormData(),this.model.updateOrder(t),r.prev=2,r.next=5,this.model.submitOrder();case 5:e=r.sent,this.showSuccess(e),this.updateBasketCounter(),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(2),console.error("Ошибка оформления заказа:",r.t0);case 13:case"end":return r.stop()}}),_callee2,this,[[2,10]])}))),function processOrderStep2(){return t.apply(this,arguments)})},{key:"showSuccess",value:function showSuccess(t){this.successMessage.render(t),this.modal.setContent(this.successMessage.element)}}]),App}();new p(new n(new t("https://larek-api.nomoreparties.co/api/weblarek")))})();
//# sourceMappingURL=main.js.map